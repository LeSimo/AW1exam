{"ast":null,"code":"var _jsxFileName = \"/home/kali/Desktop/AW1/exam/client/src/App.js\";\nimport React from 'react';\nimport './App.css';\nimport API from './API/API';\nimport { BrowserRouter as Router, Route, Switch, Redirect } from 'react-router-dom';\nimport NavBar from './Components/NavBar';\nimport SideBar from './Components/SideBar';\nimport CarList from './Components/CarList';\nimport LoginForm from './Components/LoginForm';\nimport RentalsList from './Components/RentalsList';\nimport Configurator from './Components/Configurator';\nimport PaymentForm from './Components/PaymentForm';\nimport { Row, Col, Container } from 'react-bootstrap';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.loadIniatialData = () => {\n      API.getBrands().then(b => {\n        this.setState({\n          brands: b\n        });\n      });\n      API.getCars().then(c => {\n        this.setState({\n          cars: c\n        });\n      });\n      API.getCategories().then(c => {\n        this.setState({\n          categories: c\n        });\n      });\n    };\n\n    this.logout = () => {\n      this.setState({\n        isLogged: false\n      });\n      API.userLogout().then(() => {\n        this.setState({\n          authUser: null,\n          authErr: null,\n          isLogged: false,\n          rentals: [],\n          payState: '',\n          rent: {\n            CarId: '',\n            EndDate: '',\n            StartDate: '',\n            UserId: '',\n            cost: ''\n          }\n        });\n        API.getCars().catch(errorObj => {\n          this.handleErrors(errorObj);\n        });\n      }); //this.setState({ isLogged: false })\n    };\n\n    this.login = (username, password) => {\n      API.userLogin(username, password).then(user => {\n        this.setState({\n          isLogged: true,\n          authUser: user\n        });\n        API.getRentals(this.state.authUser.userID).then(rentals => {\n          this.setState({\n            rentals: rentals,\n            authErr: null\n          });\n        }).catch(errorObj => {\n          this.handleErrors(errorObj);\n        });\n      }).catch(errorObj => {\n        const err0 = errorObj.errors[0];\n        this.setState({\n          authErr: err0\n        }); //this.props.history.push(\"/configurator\")\n      });\n    };\n\n    this.pay = (card, cost) => {\n      this.setState({\n        payState: 'included'\n      });\n      API.stub(card, cost).then(boolvalue => {\n        console.log('Entra nel primo then');\n\n        if (boolvalue) {\n          API.addRent(this.state.rent).then(() => {\n            this.setState({\n              rent: '',\n              payState: 'none'\n            });\n            API.getRentals(this.state.authUser.userID).then(rentals => {\n              this.setState({\n                rentals: rentals,\n                authErr: null\n              });\n            }).catch(errorObj => {\n              this.handleErrors(errorObj);\n            });\n          }).catch(errorObj => {\n            const err0 = errorObj.errors[0];\n            this.setState({\n              authErr: err0\n            });\n            this.handleErrors(errorObj);\n          });\n        } else {\n          console.log('Sono nel caso false');\n          this.setState({\n            payState: \"error\"\n          });\n        }\n      }).catch(errorObj => {\n        const err0 = errorObj.errors[0];\n        this.setState({\n          payState: err0\n        });\n      });\n    };\n\n    this.deleteRent = invoice => {\n      API.deleteRent(invoice).then(() => {\n        API.getRentals(this.state.authUser.userID).then(rentals => {\n          this.setState({\n            rentals: rentals,\n            authErr: null\n          });\n        });\n      }).catch(errorObj => {\n        this.handleErrors(errorObj);\n      });\n    };\n\n    this.setRent = rent => {\n      this.setState({\n        rent: rent\n      });\n    };\n\n    this.addOrRemoveBrandsFilters = brand => {\n      let brandsFilters = this.state.brandsFilters;\n\n      if (brandsFilters.includes(brand)) {\n        brandsFilters = brandsFilters.filter(b => b !== brand);\n      } else {\n        brandsFilters.push(brand);\n      }\n\n      this.setState({\n        brandsFilters: brandsFilters\n      });\n    };\n\n    this.addOrRemoveCategoriesFilters = category => {\n      let categoriesFilters = this.state.categoriesFilters;\n\n      if (categoriesFilters.includes(category)) {\n        categoriesFilters = categoriesFilters.filter(c => c !== category);\n      } else {\n        categoriesFilters.push(category);\n      }\n\n      this.setState({\n        categoriesFilters: categoriesFilters\n      });\n    };\n\n    this.state = {\n      brands: [],\n      cars: [],\n      categories: [],\n      rentals: [],\n      isLogged: false,\n      loading: false,\n      errorMsg: '',\n      brandsFilters: [],\n      categoriesFilters: [],\n      authUser: '',\n      authErr: '',\n      rent: null,\n      payState: 'none'\n    };\n  }\n\n  handleErrors(err) {\n    if (err) {\n      if (err.status && err.status === 401) {\n        this.setState({\n          authErr: err.errorObj\n        }); //this.props.history.push(\"/cars\");\n      }\n    }\n  } // Add a logout method\n\n\n  componentDidMount() {\n    this.setState({\n      loading: true\n    });\n    this.loadIniatialData();\n    this.setState({\n      loading: false\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Router, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(NavBar, {\n      isLogged: this.state.isLogged,\n      authUser: this.state.authUser,\n      logoutMethod: this.logout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      path: \"/cars\",\n      render: props => {\n        if (this.state.isLogged) return /*#__PURE__*/React.createElement(Redirect, {\n          to: \"/configurator\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 22\n          }\n        });else {\n          return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Container, {\n            fluid: true,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 17\n            }\n          }, /*#__PURE__*/React.createElement(Row, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 19\n            }\n          }, /*#__PURE__*/React.createElement(SideBar, {\n            brands: this.state.brands,\n            categories: this.state.categories,\n            brandsFilters: this.state.brandsFilters,\n            categoriesFilters: this.state.categoriesFilters,\n            addOrRemoveBrandsFilters: this.addOrRemoveBrandsFilters,\n            addOrRemoveCategoriesFilters: this.addOrRemoveCategoriesFilters,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 21\n            }\n          }), /*#__PURE__*/React.createElement(CarList, {\n            cars: this.state.cars,\n            brandsFilters: this.state.brandsFilters,\n            categoriesFilters: this.state.categoriesFilters,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 21\n            }\n          }))));\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/login\",\n      render: props => {\n        return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Row, {\n          className: \"vheight-100\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(Col, {\n          md: 4,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 17\n          }\n        }), /*#__PURE__*/React.createElement(Col, {\n          md: 4,\n          className: \"below-nav\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(LoginForm, {\n          loginMethod: this.login,\n          authErr: this.state.authErr,\n          isLogged: this.state.isLogged,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 19\n          }\n        }))));\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/rentals\",\n      render: props => {\n        if (!this.state.isLogged) {\n          return /*#__PURE__*/React.createElement(Redirect, {\n            to: \"/cars\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 22\n            }\n          });\n        } else {\n          return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Container, {\n            fluid: true,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 17\n            }\n          }, /*#__PURE__*/React.createElement(Row, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 19\n            }\n          }, /*#__PURE__*/React.createElement(RentalsList, {\n            rentals: this.state.rentals,\n            deleteRent: this.deleteRent,\n            cars: this.state.cars,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 221,\n              columnNumber: 21\n            }\n          }))));\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/configurator\",\n      render: props => {\n        if (!this.state.isLogged) {\n          return /*#__PURE__*/React.createElement(Redirect, {\n            to: \"/cars\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 22\n            }\n          });\n        }\n        /*\n        if(this.state.payState === 'included'){\n         return <Redirect to=\"/payment\" />\n        }*/\n        else {\n            return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Configurator, {\n              categories: this.state.categories,\n              handleErrors: this.handleErrors,\n              cars: this.state.cars,\n              rentals: this.state.rentals,\n              UserId: this.state.authUser.userID,\n              setRent: this.setRent,\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 240,\n                columnNumber: 17\n              }\n            }));\n          }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/payment\",\n      render: props => {\n        if (!this.state.isLogged) {\n          return /*#__PURE__*/React.createElement(Redirect, {\n            to: \"/cars\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 22\n            }\n          });\n        } else {\n          return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(PaymentForm, {\n            isLogged: this.state.isLogged,\n            payMethod: this.pay,\n            payState: this.state.payState,\n            cost: this.state.rent.cost,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 17\n            }\n          }));\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/\",\n      render: props => {\n        if (this.state.isLogged) return /*#__PURE__*/React.createElement(Redirect, {\n          to: \"/configurator\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 22\n          }\n        });else {\n          return /*#__PURE__*/React.createElement(Redirect, {\n            to: \"/cars\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 22\n            }\n          });\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 11\n      }\n    }))));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/kali/Desktop/AW1/exam/client/src/App.js"],"names":["React","API","BrowserRouter","Router","Route","Switch","Redirect","NavBar","SideBar","CarList","LoginForm","RentalsList","Configurator","PaymentForm","Row","Col","Container","App","Component","constructor","props","loadIniatialData","getBrands","then","b","setState","brands","getCars","c","cars","getCategories","categories","logout","isLogged","userLogout","authUser","authErr","rentals","payState","rent","CarId","EndDate","StartDate","UserId","cost","catch","errorObj","handleErrors","login","username","password","userLogin","user","getRentals","state","userID","err0","errors","pay","card","stub","boolvalue","console","log","addRent","deleteRent","invoice","setRent","addOrRemoveBrandsFilters","brand","brandsFilters","includes","filter","push","addOrRemoveCategoriesFilters","category","categoriesFilters","loading","errorMsg","err","status","componentDidMount","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './App.css';\nimport API from './API/API'\nimport { BrowserRouter as Router, Route, Switch, Redirect } from 'react-router-dom';\nimport NavBar from './Components/NavBar'\nimport SideBar from './Components/SideBar'\nimport CarList from './Components/CarList'\nimport LoginForm from './Components/LoginForm'\nimport RentalsList from './Components/RentalsList'\nimport Configurator from './Components/Configurator'\nimport PaymentForm from './Components/PaymentForm'\nimport { Row, Col, Container} from 'react-bootstrap'\n\n\nclass App extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      brands: [], cars: [], categories: [], rentals: [], isLogged: false,\n      loading: false, errorMsg: '', brandsFilters: [], categoriesFilters: [],\n      authUser: '', authErr: '', rent: null, payState: 'none'\n    };\n  }\n\n  loadIniatialData = () => {\n    API.getBrands().then(\n      (b) => {\n        this.setState({ brands: b })\n\n      })\n\n    API.getCars().then(\n      (c) => {\n        this.setState({ cars: c })\n\n      })\n    API.getCategories().then(\n      (c) => {\n        this.setState({ categories: c })\n      })\n  }\n\n  handleErrors(err) {\n    if (err) {\n      if (err.status && err.status === 401) {\n        this.setState({ authErr: err.errorObj });\n        //this.props.history.push(\"/cars\");\n      }\n    }\n  }\n\n\n  // Add a logout method\n  logout = () => {\n    this.setState({ isLogged: false })\n    API.userLogout().then(() => {\n      this.setState({ authUser: null, authErr: null, isLogged: false, rentals: [], payState: '',\n      rent: {CarId: '',EndDate: '',StartDate: '',UserId:'',cost:''}\n    });\n      API.getCars().catch((errorObj) => { this.handleErrors(errorObj) });\n    });\n    //this.setState({ isLogged: false })\n\n  }\n\n\n  // Login method\n  login = (username, password) => {\n    API.userLogin(username, password).then(\n      (user) => {\n        this.setState({ isLogged: true, authUser: user })\n        API.getRentals(this.state.authUser.userID)\n          .then((rentals) => {\n            this.setState({ rentals: rentals, authErr: null });  \n          })\n          .catch((errorObj) => {\n            this.handleErrors(errorObj);\n          });\n      }\n    ).catch(\n      (errorObj) => {\n        const err0 = errorObj.errors[0];\n        this.setState({ authErr: err0 });\n        //this.props.history.push(\"/configurator\")\n      }\n    );\n\n  }\n\n  // Pay method\n  pay = (card, cost) => {\n    this.setState({payState: 'included'});\n    API.stub(card, cost).then((boolvalue) => {\n      console.log('Entra nel primo then')\n      if (boolvalue) {\n        API.addRent(this.state.rent)\n          .then(() => {\n            this.setState({ rent: '', payState: 'none' });\n            API.getRentals(this.state.authUser.userID)\n              .then((rentals) => {\n                this.setState({ rentals: rentals, authErr: null });\n              })\n              .catch((errorObj) => {\n                this.handleErrors(errorObj);\n              });\n          })\n          .catch((errorObj) => {\n            const err0 = errorObj.errors[0];\n            this.setState({ authErr: err0 });\n            this.handleErrors(errorObj);\n          });\n      }else{\n        console.log('Sono nel caso false')\n        this.setState({payState:\"error\"})\n      }\n    })\n      .catch(\n        (errorObj) => {\n          const err0 = errorObj.errors[0];\n          this.setState({ payState: err0 });\n        }\n      );\n\n  }\n\n\n  deleteRent = (invoice) => {\n    API.deleteRent(invoice).then(() => {\n      API.getRentals(this.state.authUser.userID)\n        .then((rentals) => {\n          this.setState({ rentals: rentals, authErr: null });\n        })\n    }).catch((errorObj) => {\n      this.handleErrors(errorObj)\n    })\n  }\n\n  setRent = (rent) => {\n    this.setState({ rent: rent })\n  }\n\n  componentDidMount() {\n    this.setState({ loading: true })\n    this.loadIniatialData();\n    this.setState({ loading: false });\n  }\n\n  addOrRemoveBrandsFilters = (brand) => {\n    let brandsFilters = this.state.brandsFilters;\n    if (brandsFilters.includes(brand)) {\n      brandsFilters = brandsFilters.filter((b) => b !== brand)\n    }\n    else {\n      brandsFilters.push(brand);\n    }\n    this.setState({ brandsFilters: brandsFilters })\n  }\n\n  addOrRemoveCategoriesFilters = (category) => {\n    let categoriesFilters = this.state.categoriesFilters;\n    if (categoriesFilters.includes(category)) {\n      categoriesFilters = categoriesFilters.filter((c) => c !== category)\n    }\n    else {\n      categoriesFilters.push(category);\n    }\n    this.setState({ categoriesFilters: categoriesFilters })\n  }\n\n\n\n\n\n  render() {\n    return <>\n      <Router>\n        <NavBar isLogged={this.state.isLogged} authUser={this.state.authUser}\n          logoutMethod={this.logout} />\n\n        <Switch>\n          <Route path='/cars' render={(props) => {\n            if (this.state.isLogged)\n              return <Redirect to='/configurator' />;\n            else {\n              return <>\n\n                <Container fluid>\n                  <Row>\n                    <SideBar brands={this.state.brands} categories={this.state.categories}\n                      brandsFilters={this.state.brandsFilters} categoriesFilters={this.state.categoriesFilters}\n                      addOrRemoveBrandsFilters={this.addOrRemoveBrandsFilters} addOrRemoveCategoriesFilters={this.addOrRemoveCategoriesFilters} />\n                    <CarList cars={this.state.cars} brandsFilters={this.state.brandsFilters} categoriesFilters={this.state.categoriesFilters} />\n                  </Row>\n                </Container>\n              </>\n\n            }\n          }} />\n\n          <Route path='/login' render={(props) => {\n            return <>\n              <Row className=\"vheight-100\">\n                <Col md={4}></Col>\n                <Col md={4} className=\"below-nav\">\n                  <LoginForm loginMethod={this.login} authErr={this.state.authErr} isLogged={this.state.isLogged} />\n                </Col>\n              </Row>\n            </>\n\n          }}>\n          </Route>\n\n          <Route path=\"/rentals\" render={(props) => {\n            if (!this.state.isLogged) {\n              return <Redirect to=\"/cars\" />\n            } else {\n              return <>\n                <Container fluid>\n                  <Row>\n                    <RentalsList rentals={this.state.rentals} deleteRent={this.deleteRent} cars={this.state.cars} />\n                  </Row>\n                </Container>\n              </>\n            }\n          }}>\n\n          </Route>\n\n\n          <Route path='/configurator' render={(props) => {\n            if (!this.state.isLogged) {\n              return <Redirect to=\"/cars\" />\n            }/*\n            if(this.state.payState === 'included'){\n              return <Redirect to=\"/payment\" />\n            }*/\n             else {\n              return <>\n                <Configurator categories={this.state.categories} handleErrors={this.handleErrors} cars={this.state.cars} rentals={this.state.rentals}\n                  UserId={this.state.authUser.userID} setRent={this.setRent} />\n              </>\n            }\n          }} />\n\n\n          <Route path='/payment' render={(props) => {\n            if (!this.state.isLogged) {\n              return <Redirect to=\"/cars\" />\n            } else {\n              return <>\n                <PaymentForm isLogged={this.state.isLogged} payMethod={this.pay}  payState={this.state.payState} cost={this.state.rent.cost} />\n              </>\n            }\n          }} />\n\n\n\n          <Route path='/' render={(props) => {\n            if (this.state.isLogged)\n              return <Redirect to='/configurator' />;\n            else {\n              return <Redirect to='/cars' />\n            }\n          }}>\n          </Route>\n\n\n        </Switch>\n\n\n      </Router>\n\n    </>\n  }\n\n}\n\nexport default App;\n\n\n\n"]},"metadata":{},"sourceType":"module"}